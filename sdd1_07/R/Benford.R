## Distribution du premier chiffre pour une distribution uniforme
x <- runif(2000, min = 1, max = 1000)
x[1:20]
x1 <- substr(as.character(x), 1, 1)
x1[1:20]
tab <- table(x1) / length(x1)
tab
barplot(tab, col = "cornsilk", ylim = c(0, 0.35), width = 1,
  space = 0, xlab = "Chiffre", ylab = "Occurences")
points((1:9) - 0.5, log10(1 + 1/1:9), pch = 19, col = "blue")
axis(1, at = (1:9) - 0.5, labels = 1:9)

## Distribution du dernier chiffre devant la virgule pour la population de pays
# Population taken from 223 countries

## from Wikipedia, last visit 2010/09/21
pop <- c(1339600000, 1187890000, 310297000, 237556363, 193539000, 170592000,
         164425000, 158259000, 141927297, 127390000, 108396211, 94013200, 85846997,
         81802257, 79221000, 79056000, 75078000, 72561312, 67827000, 67070000,
         65447374, 62008049, 60402499, 50496000, 49991300, 49773145, 46072834,
         45871738, 45629000, 45040000, 40518951, 39151490, 38610697, 38167329,
         35423000, 34051000, 33796000, 21028000, 29853000, 29461933, 29117000,
         28936000, 28306700, 27794000, 27136977, 24333000, 24256000, 23991000,
         23406000, 23131093, 22505000, 22467576, 21571000, 21466174, 20410000,
         20146000, 19958000, 18993000, 17132000, 16615500, 16287000, 16197000,
         15891000, 15692000, 14517176, 14377000, 14250000, 13395682, 13257000,
         12861000, 12644000, 11306183, 11274106, 11204000, 10827519, 10636888,
         10512397, 10432500, 10324000, 10277000, 10225000, 10188000, 10031000,
         10013628, 9856000, 9467700, 9380447, 9365000, 9212000, 8997400, 8519000,
         8372930, 7782900, 7627800, 7616000, 7576771, 7075000, 7026400, 6888000,
         6780000, 6546000, 6472000, 6460000, 6436000, 6194000, 5836000, 5822000,
         5550000, 5543819, 5429773, 5368700, 5224000, 5177000, 5076700, 4903400,
         4707000, 4640000, 4506000, 4459300, 4436000, 4435056, 4390000, 4255000,
         3998000, 3935249, 3760000, 3759000, 3563800, 3476608, 3372000, 3366000,
         3329227, 3322576, 3238000, 3195000, 3051000, 2905000, 2774000, 2730000,
         2237600, 2212000, 2084000, 2064770, 2048620, 1978000, 1751000, 1696563,
         1647000, 1501000, 1344000, 1340021, 1297000, 1202000, 1171000, 879000,
         854000, 807000, 801851, 761000, 708000, 693000, 691000, 626000, 542200,
         536000, 530000, 524000, 513000, 502207, 416333, 407000, 346000, 322100,
         318006, 314000, 257000, 246000, 201000, 180000, 179000, 174000, 165000,
         111000, 109000, 109000, 107000, 104000, 104000, 100000, 90050, 89000,
         88000, 85000, 84000, 80000, 69000, 67000, 65000, 63000, 61811 ,57000,
         57000, 52000, 48760, 35904, 33000, 33000, 33000, 31794, 31000, 23000,
         20000, 20000, 15000, 10000, 10000, 5900, 4500, 3000, 1500, 1200, 800, 50)

dpop <- substr(as.character(pop), 1, 1)

# Proportions of the various digits
tablpop <- table(dpop) /length(dpop)
tablpop
benf <- log10(1 + 1/1:9)

## Do the plot:
barplot(tablpop, col = "cornsilk", space = 0,
        main = "Populations par pays", ylim = c(0, max(benf, tablpop)*1.05))
points(1:9 - 0.5, benf, col = "blue", pch = 19)
